CREATE TABLE temp_table(
	 ride_id CHAR(45)
	 , user_id CHAR(45)
	 , time_ride_start TIMESTAMP
	 , time_ride_end TIMESTAMP
	 , lng_start FLOAT
	 , lat_start FLOAT      
	 , lng_end FLOAT
	 , lat_end FLOAT   
	 , booking_amount FLOAT
	 , UNIQUE(ride_id) 
);

COPY temp_table(
	ride_id
	, user_id
	, time_ride_start
	, time_ride_end
	, lng_start
	, lat_start
	, lng_end
	, lat_end
	, booking_amount
) FROM '/Users/wester/Documents/data-engineer-test-5-/data-engineer-test-rides'
	DELIMITER ','
	CSV HEADER;

INSERT INTO a_dott_rides(
	ride_id
	, user_id
	, time_ride_start
	, time_ride_end
	, lng_start
	, lat_start
	, lng_end
	, lat_end
	, booking_amount
) 
SELECT *
	FROM temp_table
	ON CONFLICT (ride_id)
		DO NOTHING;
		
DROP TABLE temp_table
